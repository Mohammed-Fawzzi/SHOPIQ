import{r as t,U as x,u as g,j as e,L as f,f as b}from"./index-BAlKlOWj.js";import{a as j}from"./axios-C8DqakIB.js";import{c as w,a as l,u as v}from"./index.esm-Bq2wrOFH.js";import{H as N}from"./Helmet-BXMTIC_i.js";function $(){const{setUserToken:n,setUserData:d}=t.useContext(x),m=g(),[c,r]=t.useState(!1),[i,o]=t.useState("");async function u(p){try{r(!0);let{data:a}=await j.post("https://ecommerce.routemisr.com/api/v1/auth/signin",p);a.message==="success"&&(n(a.token),localStorage.setItem("userToken",a.token),localStorage.setItem("userName",a.user.name),localStorage.setItem("userData",JSON.stringify(a.user)),d(a.user),o(""),r(!1),m("/"))}catch(a){o(a.response.data.message),r(!1)}}const h=w({email:l().email().required("Email is required"),password:l().matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,"Password must be at least 8 characters long, contain at least one letter, one number and one special character.").required("Password is required")});let s=v({initialValues:{email:"",password:""},validationSchema:h,onSubmit:u});return e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx("meta",{charSet:"utf-8"}),e.jsx("title",{children:"Login"})]}),e.jsxs("div",{className:"container py-5 my-5",children:[e.jsx("h3",{className:"text-main mt-3 fw-bold",children:"Login"}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[i?e.jsx("p",{className:"alert alert-danger p-2 my-2",children:i}):"",e.jsxs("form",{onSubmit:s.handleSubmit,children:[e.jsxs("div",{className:"my-3",children:[e.jsx("label",{htmlFor:"email",children:"Email :"}),e.jsx("input",{type:"email",className:"form-control w-100 my-2",id:"email",name:"email",value:s.values.email,onChange:s.handleChange,onBlur:s.handleBlur}),s.errors.email&&s.touched.email?e.jsx("div",{className:"alert alert-danger p-2",children:s.errors.email}):""]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",children:"Password :"}),e.jsx("input",{type:"password",className:"form-control w-100 my-2",id:"password",name:"password",value:s.values.password,onChange:s.handleChange,onBlur:s.handleBlur}),s.errors.password&&s.touched.password?e.jsx("div",{className:"alert alert-danger p-2",children:s.errors.password}):""]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx(f,{className:"mt-1 fw-bold",to:"/forgetPassword",children:"Forget your password ?"}),e.jsx("button",{className:"btn bg-main d-block text-white ms-auto",type:"submit",disabled:!(s.isValid&&s.dirty),children:c?e.jsx(b,{height:"20",width:"50",color:"#fff",ariaLabel:"bars-loading",visible:!0}):"Login"})]})]})]})})]})]})}export{$ as default};
